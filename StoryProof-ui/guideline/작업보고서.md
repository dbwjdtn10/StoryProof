# 툴바 컴포넌트화 및 모드 분리 작업 보고서

안녕하세요! 요청하신 대로 툴바 기능을 **'작가 모드(Author Mode)'**와 **'독자 모드(Reader Mode)'**로 완벽하게 분리하고 컴포넌트화하였습니다. 또한, 어느 모드에서나 환경설정에 쉽게 접근할 수 있도록 기능을 통합하였습니다.

## 1. 주요 변경 사항 및 구조

이번 작업에서는 기존의 단일 툴바 구조를 역할에 따라 두 개의 독립된 컴포넌트로 분리하고, 부모 컴포넌트인 `ChapterDetail`에서 현재 모드(`mode`)에 따라 이를 교체하여 렌더링하도록 변경하였습니다.

### 작성되거나 변경된 파일 목록

| 파일 경로 | 변경 유형 | 주요 내용 |
| :--- | :--- | :--- |
| `AuthorToolbar.tsx` | **[NEW]** | 작가 모드 전용 툴바. 기존 `NovelToolbar` 기능을 계승하며 '환경설정' 버튼 추가. |
| `ReaderToolbar.tsx` | **[MODIFY]** | 독자 모드 전용 툴바. '환경설정' 버튼 추가 및 관련 props 연동. |
| `ChapterDetail.tsx` | **[MODIFY]** | 현재 모드에 따라 툴바를 교체하고, 환경설정 모달(`SettingsModal`)의 상태를 관리. |

---

## 2. 파일별 상세 변경 내역

### 1) [NEW] `AuthorToolbar.tsx` (작가 모드 툴바)
- **역할**: 작가가 소설을 집필할 때 필요한 서식 도구(굵게, 기울임, 정렬, 리스트 등)를 제공합니다.
- **주요 기능**:
    - Tiptap 에디터의 `editor` 인스턴스를 직접 제어하여 실시간으로 서식을 적용합니다.
    - 실행 취소(Undo), 다시 실행(Redo), 스타일 선택, 글꼴/크기 조절, 정렬, 줄 간격, 사진/표 삽입 기능을 포함합니다.
    - **[추가]** 툴바 우측 끝에 **'환경설정(톱니바퀴)'** 버튼을 추가하여 클릭 시 즉시 설정을 바꿀 수 있게 했습니다.

### 2) [MODIFY] `ReaderToolbar.tsx` (독자 모드 툴바)
- **역할**: 독자가 소설을 읽을 때 쾌적한 환경을 설정할 수 있는 도구를 제공합니다.
- **주요 기능**:
    - 글자 크기, 글꼴 변경, 테마(라이트/세피아/다크), 본문 너비 조절 기능을 팝오버 형태로 제공합니다.
    - 책갈피, 하이라이트, 메모 추가 기능을 포함합니다.
    - **[변경]** `onOpenSettings` props를 추가로 받아, 툴바에서 바로 공통 **'환경설정'**을 열 수 있는 버튼을 추가하였습니다.

### 3) [MODIFY] `ChapterDetail.tsx` (메인 에디터 페이지)
- **역할**: 소설의 본문을 보여주고, 상단의 헤더와 툴바를 배치하는 컨트롤러 역할을 합니다.
- **주요 변경 사항**:
    - **상태 관리**: `isSettingsOpen`이라는 `useState`를 추가하여 환경설정 모달의 열림/닫힘을 제어합니다.
    - **컴포넌트 교체**: `mode === 'reader'` 조건에 따라 `ReaderToolbar` 또는 `AuthorToolbar`가 나오도록 로직을 수정하였습니다.
    - **함수 전달**: 각 툴바 컴포넌트에 `setIsSettingsOpen(true)`를 호출하는 콜백 함수를 전달하여, 툴바 내 버튼 클릭 시 모달이 뜨도록 연결했습니다.
    - **모달 배치**: 페이지 최하단에 `SettingsModal`을 배치하여 어디서든 호출될 수 있도록 구성했습니다.

---

## 3. 작동 원리

1.  **모드 전환**: 사용자가 소설 상세 페이지에 들어올 때 전달된 `mode` 값에 따라 UI가 결정됩니다.
2.  **툴바 렌더링**:
    - `writer` 모드일 때: `AuthorToolbar`가 활성화되며 집필 도구들이 나타납니다.
    - `reader` 모드일 때: `ReaderToolbar`가 활성화되며 독서 전용 설정 도구들이 나타납니다.
3.  **환경설정 연동**:
    - 어떤 모드에 있든 툴바의 톱니바퀴 아이콘을 누르면 부모인 `ChapterDetail`의 `isSettingsOpen` 상태가 `true`가 됩니다.
    - 이에 따라 공통 `SettingsModal`이 화면에 나타나며, 모델 변경(Gemini 등)이나 로그아웃 기능을 사용할 수 있습니다.

이제 각 모드에 최적화된 툴바를 사용하시면서도, 언제든지 환경설정을 쉽고 빠르게 관리하실 수 있습니다!
